<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simak Cerdas - Pembelajaran Menyimak Kurikulum Merdeka</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6B8DD6 0%, #8E37D7 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Section */
        .main-header {
            background: linear-gradient(135deg, #5B7BC9 0%, #7D2AC7 100%);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            animation: slideDown 0.8s ease-out;
            text-align: center;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .main-header h1 {
            color: white;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .main-header .subtitle {
            color: #E8EEFF;
            font-size: 1.3em;
            margin-bottom: 20px;
        }

        .kurikulum-badge {
            display: inline-block;
            background: linear-gradient(135deg, #FFD93D 0%, #FF6B9D 100%);
            color: white;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 0.9em;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
        }

        /* Welcome Screen */
        .welcome-screen {
            background: white;
            border-radius: 25px;
            padding: 50px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            text-align: center;
            animation: fadeInScale 0.8s ease-out;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .welcome-screen h2 {
            color: #5B7BC9;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .welcome-screen p {
            color: #666;
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 30px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .class-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .class-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px 30px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .class-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: scale(0);
            transition: transform 0.6s ease;
        }

        .class-card:hover::before {
            transform: scale(1);
        }

        .class-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.5);
        }

        .class-card h3 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .class-card p {
            color: #E8EEFF;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .class-card ul {
            list-style: none;
            text-align: left;
            color: white;
            font-size: 0.95em;
        }

        .class-card ul li {
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
        }

        .class-card ul li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #FFD93D;
            font-weight: bold;
        }

        /* Game Screen */
        .game-screen {
            display: none;
        }

        .top-bar {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-item .label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .stat-item .value {
            color: #5B7BC9;
            font-size: 2em;
            font-weight: bold;
        }

        .back-btn {
            background: linear-gradient(135deg, #FF6B9D 0%, #FFD93D 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(255, 107, 157, 0.5);
        }

        /* Progress Bar */
        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #666;
            font-weight: bold;
        }

        .progress-bar {
            background: #E8EEFF;
            height: 15px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #FF6B9D 100%);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Content Card */
        .content-card {
            background: white;
            border-radius: 25px;
            padding: 45px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            margin-bottom: 25px;
        }

        .content-type-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .audio-section {
            background: linear-gradient(135deg, #F5F7FA 0%, #C3CFE2 100%);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 35px;
            position: relative;
            overflow: hidden;
        }

        .audio-section::before {
            content: 'üéß';
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: 4em;
            opacity: 0.2;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .audio-title {
            color: #5B7BC9;
            font-size: 2em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .audio-text {
            color: #333;
            font-size: 1.15em;
            line-height: 2;
            margin-bottom: 30px;
            background: white;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .audio-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .play-button {
            background: linear-gradient(135deg, #FF6B9D 0%, #FFA06B 100%);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(255, 107, 157, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: pulseButton 2s infinite;
        }

        @keyframes pulseButton {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .play-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 107, 157, 0.6);
            animation: none;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 12px 25px;
            border-radius: 50px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .speed-control label {
            color: #666;
            font-weight: bold;
        }

        .speed-control select {
            border: 2px solid #E8EEFF;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            background: white;
        }

        .audio-status {
            flex: 1;
            color: #5B7BC9;
            font-weight: bold;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Questions Section */
        .questions-section {
            margin-top: 40px;
        }

        .section-header {
            color: #5B7BC9;
            font-size: 1.8em;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #E8EEFF;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-card {
            background: #F9FAFF;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 3px solid #E8EEFF;
            transition: all 0.3s ease;
        }

        .question-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.2);
        }

        .question-number {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 18px;
            border-radius: 50px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            color: #333;
            font-size: 1.25em;
            margin-bottom: 25px;
            font-weight: 600;
            line-height: 1.6;
        }

        .options-grid {
            display: grid;
            gap: 15px;
        }

        .option {
            background: white;
            padding: 18px 25px;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid #E8EEFF;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.05em;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateX(8px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .option-letter {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1em;
            flex-shrink: 0;
        }

        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateX(8px);
        }

        .option.selected .option-letter {
            background: white;
            color: #667eea;
        }

        .option.correct {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white;
            border-color: #56ab2f;
            animation: correctPulse 0.6s ease;
        }

        .option.correct .option-letter {
            background: white;
            color: #56ab2f;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .option.wrong {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
            border-color: #eb3349;
            animation: wrongShake 0.5s ease;
        }

        .option.wrong .option-letter {
            background: white;
            color: #eb3349;
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Submit Button */
        .submit-button {
            background: linear-gradient(135deg, #FFD93D 0%, #FF6B9D 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            border-radius: 50px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.4);
            transition: all 0.3s ease;
            display: block;
            margin: 40px auto;
        }

        .submit-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255, 107, 157, 0.6);
        }

        .submit-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        /* Result Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 30px;
            padding: 60px;
            max-width: 600px;
            text-align: center;
            animation: modalSlideIn 0.5s ease;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        @keyframes modalSlideIn {
            from {
                transform: scale(0.7) translateY(-50px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .result-emoji {
            font-size: 6em;
            margin-bottom: 25px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .result-title {
            color: #5B7BC9;
            font-size: 2.8em;
            margin-bottom: 20px;
        }

        .result-details {
            background: #F9FAFF;
            padding: 25px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .result-score {
            font-size: 3em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .result-text {
            color: #666;
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .profil-pancasila {
            background: linear-gradient(135deg, #FFD93D 0%, #FF6B9D 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 25px;
            font-size: 1em;
            line-height: 1.6;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .modal-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .modal-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .modal-button.secondary {
            background: linear-gradient(135deg, #FF6B9D 0%, #FFD93D 100%);
        }

        /* Floating Elements */
        .floating-decoration {
            position: fixed;
            pointer-events: none;
            z-index: 1;
            opacity: 0.15;
            font-size: 3em;
        }

        .float-anim {
            animation: floatRandom 8s ease-in-out infinite;
        }

        @keyframes floatRandom {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(20px, -20px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-header h1 {
                font-size: 2em;
            }
            
            .class-selection {
                grid-template-columns: 1fr;
            }
            
            .content-card {
                padding: 25px;
            }
            
            .audio-controls {
                flex-direction: column;
            }
            
            .modal-content {
                padding: 30px;
                margin: 20px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Floating Decorations -->
    <div class="floating-decoration float-anim" style="left: 5%; top: 15%;">üìö</div>
    <div class="floating-decoration float-anim" style="left: 90%; top: 25%; animation-delay: 1s;">üéµ</div>
    <div class="floating-decoration float-anim" style="left: 10%; top: 70%; animation-delay: 2s;">‚ú®</div>
    <div class="floating-decoration float-anim" style="left: 85%; top: 65%; animation-delay: 3s;">üåü</div>
    <div class="floating-decoration float-anim" style="left: 50%; top: 10%; animation-delay: 4s;">üéØ</div>

    <div class="container">
        <!-- Header -->
        <div class="main-header">
            <h1><span>üéß</span> Simak Cerdas</h1>
            <p class="subtitle">Pembelajaran Menyimak Interaktif untuk Siswa SD Kelas Atas</p>
            <span class="kurikulum-badge">‚ú® Kurikulum Merdeka</span>
        </div>

        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
            <h2>Selamat Datang, Pelajar Cerdas! üåü</h2>
            <p>
                Aplikasi ini dirancang khusus untuk melatih kemampuan menyimak kamu melalui berbagai jenis teks lisan yang menarik. 
                Dengarkan dengan seksama, pahami isi cerita, dan jawab pertanyaan dengan teliti. Ayo asah keterampilan literasimu dan jadilah Pelajar Pancasila yang bernalar kritis!
            </p>
            <p style="color: #5B7BC9; font-weight: bold; font-size: 1.3em; margin-top: 30px;">
                Pilih Kelasmu untuk Memulai Petualangan Belajar:
            </p>

            <div class="class-selection">
                <div class="class-card" onclick="selectClass(4)">
                    <h3>üìò Kelas 4</h3>
                    <p>Ayo Mulai Belajar Menyimak!</p>
                    <ul>
                        <li>Cerita sederhana</li>
                        <li>Percakapan sehari-hari</li>
                        <li>Pengumuman di sekolah</li>
                        <li>Dongeng anak</li>
                    </ul>
                </div>

                <div class="class-card" onclick="selectClass(5)">
                    <h3>üìó Kelas 5</h3>
                    <p>Tingkatkan Kemampuanmu!</p>
                    <ul>
                        <li>Cerita rakyat</li>
                        <li>Teks eksplanasi lisan</li>
                        <li>Dialog tokoh</li>
                        <li>Laporan kegiatan</li>
                    </ul>
                </div>

                <div class="class-card" onclick="selectClass(6)">
                    <h3>üìï Kelas 6</h3>
                    <p>Tantangan Lebih Seru!</p>
                    <ul>
                        <li>Cerita inspiratif</li>
                        <li>Pidato pendek</li>
                        <li>Teks informasi</li>
                        <li>Berita & wawancara</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="stats">
                    <div class="stat-item">
                        <div class="label">Kelas</div>
                        <div class="value" id="currentClass">4</div>
                    </div>
                    <div class="stat-item">
                        <div class="label">Level</div>
                        <div class="value" id="currentLevel">1</div>
                    </div>
                    <div class="stat-item">
                        <div class="label">Skor</div>
                        <div class="value" id="currentScore">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="label">Benar</div>
                        <div class="value" id="correctAnswers">0/5</div>
                    </div>
                </div>
                <button class="back-btn" onclick="backToHome()">‚Üê Kembali</button>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-label">
                    <span>Progres Pembelajaran</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <!-- Content Card -->
            <div class="content-card">
                <span class="content-type-badge" id="contentType">üìñ Cerita</span>
                
                <!-- Audio Section -->
                <div class="audio-section">
                    <h2 class="audio-title" id="audioTitle">Judul Materi</h2>
                    <div class="audio-text" id="audioText">Teks akan muncul di sini...</div>
                    
                    <div class="audio-controls">
                        <button class="play-button" id="playButton" onclick="toggleAudio()">
                            <span id="playIcon">‚ñ∂Ô∏è</span>
                            <span id="playText">Putar Audio</span>
                        </button>
                        
                        <div class="speed-control">
                            <label for="speedSelect">Kecepatan:</label>
                            <select id="speedSelect" onchange="changeSpeed()">
                                <option value="0.75">Lambat (0.75x)</option>
                                <option value="1" selected>Normal (1x)</option>
                                <option value="1.25">Cepat (1.25x)</option>
                                <option value="1.5">Sangat Cepat (1.5x)</option>
                            </select>
                        </div>
                        
                        <div class="audio-status" id="audioStatus"></div>
                    </div>
                </div>

                <!-- Questions Section -->
                <div class="questions-section" id="questionsSection">
                    <h2 class="section-header">
                        <span>üìù</span>
                        <span>Pertanyaan Pemahaman</span>
                    </h2>
                    <div id="questionsContainer"></div>
                    
                    <button class="submit-button" id="submitButton" onclick="submitAnswers()" disabled>
                        Periksa Jawaban ‚úì
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Result Modal -->
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <div class="result-emoji" id="resultEmoji">üéâ</div>
            <h2 class="result-title" id="resultTitle">Hasil Belajarmu</h2>
            
            <div class="result-details">
                <div class="result-score" id="resultScore">100</div>
                <div class="result-text" id="resultText">Kamu menjawab dengan sempurna!</div>
            </div>

            <div class="profil-pancasila">
                <strong>üåü Profil Pelajar Pancasila</strong><br>
                <span id="profilPancasila">Kamu telah menunjukkan sikap bernalar kritis dengan baik!</span>
            </div>

            <div class="action-buttons">
                <button class="modal-button" onclick="nextLevel()">Level Selanjutnya ‚Üí</button>
                <button class="modal-button secondary" onclick="retryLevel()">Coba Lagi üîÑ</button>
            </div>
        </div>
    </div>

    <script>
        // Data Pembelajaran berdasarkan Kurikulum Merdeka
        const learningData = {
            4: [
                {
                    type: "üìñ Cerita Sederhana",
                    title: "Liburan ke Pantai",
                    text: "Pada hari Minggu, keluarga Dina pergi berlibur ke pantai. Mereka berangkat pagi-pagi sekali agar tidak terjebak macet. Sesampainya di pantai, Dina sangat senang melihat ombak yang besar. Ayah memasang payung dan tikar di tepi pantai. Ibu menyiapkan bekal makanan yang lezat. Dina dan adiknya bermain pasir dan membuat istana pasir yang tinggi. Mereka juga mengumpulkan kerang-kerang cantik. Saat siang, mereka berenang bersama dengan hati-hati. Ayah mengajari Dina cara berenang yang benar. Sebelum pulang, mereka membersihkan sampah dan memastikan pantai tetap bersih. Dina berjanji akan datang lagi ke pantai.",
                    questions: [
                        {
                            question: "Kapan keluarga Dina pergi ke pantai?",
                            options: [
                                "Hari Sabtu pagi",
                                "Hari Minggu pagi",
                                "Hari Senin sore",
                                "Hari Jumat siang"
                            ],
                            correct: 1
                        },
                        {
                            question: "Mengapa mereka berangkat pagi-pagi sekali?",
                            options: [
                                "Karena ingin cepat sampai",
                                "Karena takut hujan",
                                "Agar tidak terjebak macet",
                                "Karena pantai tutup siang"
                            ],
                            correct: 2
                        },
                        {
                            question: "Apa yang dilakukan Dina dan adiknya di pantai?",
                            options: [
                                "Bermain bola",
                                "Membaca buku",
                                "Bermain pasir dan membuat istana",
                                "Memancing ikan"
                            ],
                            correct: 2
                        },
                        {
                            question: "Siapa yang mengajari Dina cara berenang?",
                            options: [
                                "Ibu",
                                "Adiknya",
                                "Kakaknya",
                                "Ayah"
                            ],
                            correct: 3
                        },
                        {
                            question: "Apa yang dilakukan keluarga Dina sebelum pulang?",
                            options: [
                                "Membeli oleh-oleh",
                                "Membersihkan sampah",
                                "Bermain lagi",
                                "Tidur di pantai"
                            ],
                            correct: 1
                        }
                    ]
                },
                {
                    type: "üó£Ô∏è Percakapan Sehari-hari",
                    title: "Di Kantin Sekolah",
                    text: "Rani bertemu temannya, Budi, di kantin sekolah saat istirahat. Rani: 'Hai Budi! Sudah makan siang?' Budi: 'Belum, Rani. Aku sedang memilih makanan. Kamu sudah?' Rani: 'Sudah, aku membeli nasi goreng dan teh manis. Enak sekali!' Budi: 'Wah, aku juga mau nasi goreng kalau begitu. Bu Kantin, saya pesan nasi goreng satu dan es jeruk ya!' Bu Kantin: 'Baik, tunggu sebentar ya. Mau pakai kerupuk?' Budi: 'Ya, Bu. Terima kasih.' Setelah makan, mereka duduk di bangku taman sekolah sambil mengobrol tentang pelajaran matematika tadi pagi. Rani: 'Soal matematika tadi susah ya, Bud.' Budi: 'Iya, tapi aku senang karena akhirnya bisa mengerjakannya dengan bantuan Bu Guru.' Mereka berdua setuju untuk belajar bersama sepulang sekolah.",
                    questions: [
                        {
                            question: "Di mana Rani bertemu Budi?",
                            options: [
                                "Di kelas",
                                "Di kantin sekolah",
                                "Di perpustakaan",
                                "Di lapangan"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa yang dibeli Rani untuk makan siang?",
                            options: [
                                "Mie goreng dan susu",
                                "Nasi goreng dan teh manis",
                                "Roti dan jus",
                                "Bakso dan es teh"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa yang dipesan Budi di kantin?",
                            options: [
                                "Mie ayam dan teh",
                                "Bakso dan es jeruk",
                                "Nasi goreng dan es jeruk",
                                "Soto dan air mineral"
                            ],
                            correct: 2
                        },
                        {
                            question: "Tentang apa Rani dan Budi mengobrol?",
                            options: [
                                "Pelajaran olahraga",
                                "Pelajaran matematika",
                                "Pelajaran bahasa Inggris",
                                "Pelajaran seni"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa yang mereka sepakati untuk dilakukan sepulang sekolah?",
                            options: [
                                "Bermain bola",
                                "Belajar bersama",
                                "Pergi ke taman",
                                "Menonton film"
                            ],
                            correct: 1
                        }
                    ]
                }
            ],
            5: [
                {
                    type: "üìö Cerita Rakyat",
                    title: "Malin Kundang (Ringkasan)",
                    text: "Di sebuah desa pesisir, hiduplah seorang anak bernama Malin Kundang bersama ibunya. Mereka hidup sederhana sebagai nelayan. Suatu hari, Malin memutuskan merantau untuk mengubah nasib. Dengan berat hati, ibunya merestui keberangkatan Malin. Setelah bertahun-tahun, Malin menjadi saudagar kaya dan menikah dengan putri saudagar. Kapalnya singgah di kampung halamannya. Ibunya yang sudah tua mendengar kabar itu dan berlari menemui Malin. Namun, Malin malu mengakui ibunya yang berpakaian compang-camping. Ia bahkan mengusir ibunya dengan kasar. Hati ibunya hancur dan ia berdoa agar Malin mendapat pelajaran. Tiba-tiba langit mendung, angin kencang bertiup, dan petir menyambar. Malin dan kapalnya berubah menjadi batu. Kisah ini mengajarkan kita untuk selalu menghormati orang tua.",
                    questions: [
                        {
                            question: "Mengapa Malin Kundang memutuskan merantau?",
                            options: [
                                "Karena bosan di kampung",
                                "Untuk mengubah nasib",
                                "Karena bertengkar dengan ibu",
                                "Ingin mencari teman"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa pekerjaan Malin setelah merantau?",
                            options: [
                                "Nelayan",
                                "Petani",
                                "Saudagar kaya",
                                "Guru"
                            ],
                            correct: 2
                        },
                        {
                            question: "Mengapa Malin mengusir ibunya?",
                            options: [
                                "Karena marah",
                                "Karena tidak mengenalinya",
                                "Karena malu dengan pakaian ibunya",
                                "Karena tidak sayang lagi"
                            ],
                            correct: 2
                        },
                        {
                            question: "Apa yang terjadi pada Malin Kundang di akhir cerita?",
                            options: [
                                "Ia menjadi raja",
                                "Ia kembali ke kampung",
                                "Ia dan kapalnya berubah menjadi batu",
                                "Ia bertobat dan minta maaf"
                            ],
                            correct: 2
                        },
                        {
                            question: "Apa nilai moral dari cerita Malin Kundang?",
                            options: [
                                "Jangan sombong",
                                "Harus menghormati orang tua",
                                "Rajin bekerja akan sukses",
                                "Jangan lupa kampung halaman"
                            ],
                            correct: 1
                        }
                    ]
                },
                {
                    type: "üî¨ Teks Eksplanasi",
                    title: "Proses Terjadinya Hujan",
                    text: "Hujan adalah peristiwa alam yang sangat penting bagi kehidupan. Proses terjadinya hujan dimulai dari penguapan air di permukaan bumi, seperti laut, sungai, dan danau oleh panas matahari. Air yang menguap berubah menjadi uap air dan naik ke atmosfer. Di atmosfer yang lebih dingin, uap air mengalami kondensasi atau perubahan menjadi titik-titik air yang sangat kecil. Titik-titik air ini berkumpul dan membentuk awan. Semakin banyak titik air yang berkumpul, awan menjadi semakin tebal dan gelap. Ketika titik-titik air di awan sudah terlalu banyak dan berat, gravitasi bumi menariknya jatuh sebagai hujan. Jika suhu di atmosfer sangat dingin, air bisa jatuh sebagai salju atau hujan es. Hujan sangat bermanfaat untuk mengairi tanaman, mengisi sumber air, dan menjaga keseimbangan ekosistem.",
                    questions: [
                        {
                            question: "Apa yang menyebabkan air menguap di permukaan bumi?",
                            options: [
                                "Angin kencang",
                                "Panas matahari",
                                "Gravitasi bumi",
                                "Gerakan awan"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa yang dimaksud dengan kondensasi?",
                            options: [
                                "Air menguap ke udara",
                                "Uap air berubah menjadi titik-titik air",
                                "Air jatuh ke tanah",
                                "Air membeku menjadi es"
                            ],
                            correct: 1
                        },
                        {
                            question: "Di mana titik-titik air kecil berkumpul?",
                            options: [
                                "Di tanah",
                                "Di laut",
                                "Di awan",
                                "Di sungai"
                            ],
                            correct: 2
                        },
                        {
                            question: "Mengapa titik air di awan bisa jatuh menjadi hujan?",
                            options: [
                                "Karena angin mendorong",
                                "Karena terlalu banyak dan berat",
                                "Karena matahari menyinari",
                                "Karena awan pecah"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa manfaat hujan bagi kehidupan?",
                            options: [
                                "Membuat banjir",
                                "Merusak tanaman",
                                "Mengairi tanaman dan mengisi sumber air",
                                "Membuat udara panas"
                            ],
                            correct: 2
                        }
                    ]
                }
            ],
            6: [
                {
                    type: "üé§ Pidato Pendek",
                    title: "Pentingnya Menjaga Kebersihan Lingkungan",
                    text: "Assalamualaikum warahmatullahi wabarakatuh. Yang terhormat Bapak Kepala Sekolah, Bapak Ibu Guru, dan teman-teman yang saya cintai. Pada kesempatan ini, saya ingin menyampaikan pidato tentang pentingnya menjaga kebersihan lingkungan. Lingkungan yang bersih adalah tanggung jawab kita bersama. Kebersihan lingkungan dimulai dari hal kecil, seperti membuang sampah pada tempatnya, tidak mencoret-coret dinding, dan merawat tanaman di sekitar kita. Lingkungan yang bersih akan membuat kita sehat, nyaman, dan betah berada di sekolah. Sebaliknya, lingkungan yang kotor dapat menimbulkan penyakit, seperti diare, demam berdarah, dan penyakit kulit. Mari kita mulai dari diri sendiri. Bawalah tempat sampah kecil di tas, pisahkan sampah organik dan anorganik, dan ikuti kegiatan Jumat Bersih di sekolah. Ajak juga keluarga di rumah untuk peduli kebersihan. Ingat, kebersihan adalah sebagian dari iman. Dengan lingkungan bersih, kita bisa belajar lebih fokus dan meraih prestasi. Ayo, jadilah pahlawan lingkungan! Terima kasih atas perhatiannya. Wassalamualaikum warahmatullahi wabarakatuh.",
                    questions: [
                        {
                            question: "Apa tema pidato yang disampaikan?",
                            options: [
                                "Pentingnya belajar",
                                "Pentingnya menjaga kebersihan lingkungan",
                                "Pentingnya olahraga",
                                "Pentingnya persahabatan"
                            ],
                            correct: 1
                        },
                        {
                            question: "Sebutkan salah satu cara menjaga kebersihan yang disebutkan!",
                            options: [
                                "Tidur yang cukup",
                                "Membuang sampah pada tempatnya",
                                "Belajar dengan rajin",
                                "Bermain dengan teman"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa akibat dari lingkungan yang kotor?",
                            options: [
                                "Membuat senang",
                                "Menimbulkan penyakit",
                                "Membuat pintar",
                                "Membuat nyaman"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa nama kegiatan kebersihan di sekolah yang disebutkan?",
                            options: [
                                "Senin Bersih",
                                "Sabtu Sehat",
                                "Jumat Bersih",
                                "Minggu Riang"
                            ],
                            correct: 2
                        },
                        {
                            question: "Apa pesan utama dari pidato ini?",
                            options: [
                                "Belajar yang rajin",
                                "Jaga kebersihan dimulai dari diri sendiri",
                                "Hormati guru",
                                "Rajin olahraga"
                            ],
                            correct: 1
                        }
                    ]
                },
                {
                    type: "üì∞ Teks Informasi (Berita)",
                    title: "Lomba Cerdas Cermat Tingkat Provinsi",
                    text: "Kabar gembira datang dari SD Harapan Bangsa. Tim cerdas cermat sekolah ini berhasil meraih juara pertama dalam Lomba Cerdas Cermat Sains tingkat provinsi yang diadakan di Gedung Serbaguna, Sabtu lalu. Tim yang terdiri dari Anisa kelas 6A, Farhan kelas 6B, dan Zahra kelas 6A ini berhasil mengalahkan 25 tim dari berbagai sekolah dasar di provinsi. Mereka menjawab berbagai pertanyaan seputar sains, matematika, dan pengetahuan umum dengan sangat baik. Kepala Sekolah, Bapak Hendra Wijaya, mengungkapkan rasa bangganya. 'Ini adalah hasil kerja keras siswa dan pembimbing. Mereka berlatih setiap hari sepulang sekolah selama tiga bulan,' ujarnya. Anisa, ketua tim, mengatakan bahwa kunci kesuksesan mereka adalah kerja sama dan tidak mudah menyerah. Sebagai juara, tim ini mendapat piala bergilir, medali emas, dan beasiswa pendidikan. Mereka juga akan mewakili provinsi dalam lomba tingkat nasional bulan depan. Seluruh warga sekolah memberikan apresiasi dan dukungan untuk persiapan lomba selanjutnya.",
                    questions: [
                        {
                            question: "Apa nama sekolah yang memenangkan lomba?",
                            options: [
                                "SD Tunas Harapan",
                                "SD Harapan Bangsa",
                                "SD Cerdas Bangsa",
                                "SD Nusantara"
                            ],
                            correct: 1
                        },
                        {
                            question: "Berapa tim yang mengikuti lomba tersebut?",
                            options: [
                                "20 tim",
                                "25 tim",
                                "30 tim",
                                "15 tim"
                            ],
                            correct: 1
                        },
                        {
                            question: "Berapa lama tim berlatih sebelum lomba?",
                            options: [
                                "Satu bulan",
                                "Dua bulan",
                                "Tiga bulan",
                                "Enam bulan"
                            ],
                            correct: 2
                        },
                        {
                            question: "Apa hadiah yang diterima oleh tim juara?",
                            options: [
                                "Uang tunai",
                                "Piala, medali, dan beasiswa",
                                "Hanya piala",
                                "Komputer"
                            ],
                            correct: 1
                        },
                        {
                            question: "Apa yang akan dilakukan tim selanjutnya?",
                            options: [
                                "Liburan",
                                "Mewakili provinsi di lomba nasional",
                                "Pensiun dari lomba",
                                "Mengajar teman"
                            ],
                            correct: 1
                        }
                    ]
                }
            ]
        };

        // Variables
        let currentClassLevel = 4;
        let currentLevelIndex = 0;
        let currentAnswers = {};
        let isPlaying = false;
        let readingIndex = 0;
        let readingInterval;
        let totalScore = 0;
        let currentSpeed = 1;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let isPaused = false;

        // Initialize
        function selectClass(classNum) {
            currentClassLevel = classNum;
            currentLevelIndex = 0;
            totalScore = 0;
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('gameScreen').style.display = 'block';
            document.getElementById('currentClass').textContent = classNum;
            loadLevel();
        }

        function loadLevel() {
            currentAnswers = {};
            isPlaying = false;
            isPaused = false;
            
            // Stop any ongoing speech
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            const levelData = learningData[currentClassLevel][currentLevelIndex];
            
            document.getElementById('currentLevel').textContent = currentLevelIndex + 1;
            document.getElementById('contentType').textContent = levelData.type;
            document.getElementById('audioTitle').textContent = levelData.title;
            document.getElementById('audioText').textContent = levelData.text;
            document.getElementById('playButton').disabled = false;
            document.getElementById('playIcon').textContent = '‚ñ∂Ô∏è';
            document.getElementById('playText').textContent = 'Putar Audio';
            document.getElementById('audioStatus').textContent = '';
            document.getElementById('questionsSection').style.opacity = '0.5';
            document.getElementById('questionsSection').style.pointerEvents = 'none';
            
            loadQuestions(levelData.questions);
            updateProgress(0);
        }

        function loadQuestions(questions) {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            questions.forEach((q, qIndex) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.innerHTML = `
                    <span class="question-number">Pertanyaan ${qIndex + 1}</span>
                    <div class="question-text">${q.question}</div>
                    <div class="options-grid">
                        ${q.options.map((opt, optIndex) => `
                            <div class="option" onclick="selectAnswer(${qIndex}, ${optIndex})" data-question="${qIndex}" data-option="${optIndex}">
                                <div class="option-letter">${String.fromCharCode(65 + optIndex)}</div>
                                <span>${opt}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionCard);
            });
            
            document.getElementById('submitButton').disabled = true;
        }

        function toggleAudio() {
            if (!isPlaying && !isPaused) {
                playAudio();
            } else if (isPaused) {
                resumeAudio();
            } else {
                pauseAudio();
            }
        }

        function playAudio() {
            const text = document.getElementById('audioText').textContent;
            
            // Create speech utterance
            currentUtterance = new SpeechSynthesisUtterance(text);
            
            // Set voice to Indonesian if available
            const voices = speechSynthesis.getVoices();
            const indonesianVoice = voices.find(voice => 
                voice.lang.includes('id-ID') || voice.lang.includes('id')
            );
            if (indonesianVoice) {
                currentUtterance.voice = indonesianVoice;
            }
            
            // Set speech properties
            currentUtterance.rate = currentSpeed;
            currentUtterance.pitch = 1;
            currentUtterance.volume = 1;
            
            // Event handlers
            let wordCount = text.split(' ').length;
            let currentWord = 0;
            
            currentUtterance.onboundary = (event) => {
                if (event.name === 'word') {
                    currentWord++;
                    const progress = (currentWord / wordCount) * 50;
                    updateProgress(progress);
                    
                    // Get current word being spoken
                    const words = text.split(' ');
                    const displayWords = words.slice(Math.max(0, currentWord - 3), currentWord + 1).join(' ');
                    document.getElementById('audioStatus').innerHTML = `
                        üéôÔ∏è <strong>Sedang membaca:</strong> "${displayWords}"
                    `;
                }
            };
            
            currentUtterance.onstart = () => {
                isPlaying = true;
                isPaused = false;
                document.getElementById('playIcon').textContent = '‚è∏Ô∏è';
                document.getElementById('playText').textContent = 'Jeda Audio';
                document.getElementById('audioStatus').innerHTML = 'üéôÔ∏è <strong>Memulai audio...</strong>';
            };
            
            currentUtterance.onend = () => {
                finishAudio();
            };
            
            currentUtterance.onerror = (event) => {
                console.error('Speech error:', event);
                document.getElementById('audioStatus').innerHTML = '‚ùå <strong>Terjadi kesalahan. Coba lagi.</strong>';
                resetAudioButton();
            };
            
            // Start speaking
            speechSynthesis.speak(currentUtterance);
        }

        function pauseAudio() {
            if (speechSynthesis.speaking && !speechSynthesis.paused) {
                speechSynthesis.pause();
                isPaused = true;
                isPlaying = false;
                document.getElementById('playIcon').textContent = '‚ñ∂Ô∏è';
                document.getElementById('playText').textContent = 'Lanjutkan Audio';
                document.getElementById('audioStatus').innerHTML = '‚è∏Ô∏è <strong>Audio dijeda</strong>';
            }
        }

        function resumeAudio() {
            if (speechSynthesis.paused) {
                speechSynthesis.resume();
                isPaused = false;
                isPlaying = true;
                document.getElementById('playIcon').textContent = '‚è∏Ô∏è';
                document.getElementById('playText').textContent = 'Jeda Audio';
                document.getElementById('audioStatus').innerHTML = 'üéôÔ∏è <strong>Melanjutkan audio...</strong>';
            }
        }

        function finishAudio() {
            isPlaying = false;
            isPaused = false;
            document.getElementById('playIcon').textContent = '‚úì';
            document.getElementById('playText').textContent = 'Selesai';
            document.getElementById('playButton').disabled = true;
            document.getElementById('audioStatus').innerHTML = '‚úÖ <strong>Audio selesai! Silakan jawab pertanyaan di bawah.</strong>';
            document.getElementById('questionsSection').style.opacity = '1';
            document.getElementById('questionsSection').style.pointerEvents = 'auto';
            updateProgress(50);
        }

        function resetAudioButton() {
            isPlaying = false;
            isPaused = false;
            document.getElementById('playIcon').textContent = '‚ñ∂Ô∏è';
            document.getElementById('playText').textContent = 'Putar Audio';
            document.getElementById('playButton').disabled = false;
        }

        function changeSpeed() {
            currentSpeed = parseFloat(document.getElementById('speedSelect').value);
            
            // If audio is playing, restart with new speed
            if (isPlaying || isPaused) {
                speechSynthesis.cancel();
                resetAudioButton();
                document.getElementById('audioStatus').innerHTML = '‚öôÔ∏è <strong>Kecepatan diubah. Klik Putar Audio untuk memulai kembali.</strong>';
            }
        }

        function selectAnswer(questionIndex, optionIndex) {
            const options = document.querySelectorAll(`[data-question="${questionIndex}"]`);
            options.forEach(opt => opt.classList.remove('selected'));
            
            const selectedOption = document.querySelector(`[data-question="${questionIndex}"][data-option="${optionIndex}"]`);
            selectedOption.classList.add('selected');
            
            currentAnswers[questionIndex] = optionIndex;
            
            const levelData = learningData[currentClassLevel][currentLevelIndex];
            if (Object.keys(currentAnswers).length === levelData.questions.length) {
                document.getElementById('submitButton').disabled = false;
            }
        }

        function submitAnswers() {
            const levelData = learningData[currentClassLevel][currentLevelIndex];
            let correctCount = 0;
            
            levelData.questions.forEach((q, qIndex) => {
                const options = document.querySelectorAll(`[data-question="${qIndex}"]`);
                options.forEach((opt, optIndex) => {
                    opt.style.pointerEvents = 'none';
                    
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                        if (currentAnswers[qIndex] === q.correct) {
                            correctCount++;
                        }
                    } else if (currentAnswers[qIndex] === optIndex) {
                        opt.classList.add('wrong');
                    }
                });
            });
            
            const scoreGained = Math.round((correctCount / levelData.questions.length) * 100);
            totalScore += scoreGained;
            
            document.getElementById('currentScore').textContent = totalScore;
            document.getElementById('correctAnswers').textContent = `${correctCount}/${levelData.questions.length}`;
            document.getElementById('submitButton').style.display = 'none';
            
            updateProgress(100);
            
            setTimeout(() => showResult(correctCount, levelData.questions.length), 1000);
        }

        function showResult(correct, total) {
            const percentage = (correct / total) * 100;
            const modal = document.getElementById('resultModal');
            
            let emoji, title, profilText;
            
            if (percentage === 100) {
                emoji = 'üéâ';
                title = 'Sempurna!';
                profilText = 'Luar biasa! Kamu menunjukkan sikap <strong>Bernalar Kritis</strong> dengan memahami informasi dengan sangat baik. Kamu juga menunjukkan <strong>Kemandirian</strong> dalam menyelesaikan tantangan. Terus pertahankan semangat belajarmu!';
            } else if (percentage >= 80) {
                emoji = 'üòä';
                title = 'Hebat Sekali!';
                profilText = 'Bagus! Kamu telah menunjukkan kemampuan <strong>Bernalar Kritis</strong> yang baik dalam menyimak. Terus tingkatkan fokus dan ketelitianmu untuk menjadi lebih baik lagi!';
            } else if (percentage >= 60) {
                emoji = 'üëç';
                title = 'Bagus!';
                profilText = 'Cukup baik! Kamu sudah berusaha dengan baik. Latih terus kemampuan menyimakmu. Dengan <strong>Kemandirian</strong> dan ketekunan, kamu pasti bisa lebih baik!';
            } else {
                emoji = 'üí™';
                title = 'Tetap Semangat!';
                profilText = 'Jangan menyerah! Setiap usaha adalah pembelajaran. Dengarkan audio dengan lebih fokus dan baca pertanyaan dengan teliti. Kamu pasti bisa!';
            }
            
            document.getElementById('resultEmoji').textContent = emoji;
            document.getElementById('resultTitle').textContent = title;
            document.getElementById('resultScore').textContent = Math.round(percentage) + '%';
            document.getElementById('resultText').textContent = `Kamu menjawab ${correct} dari ${total} pertanyaan dengan benar!`;
            document.getElementById('profilPancasila').innerHTML = profilText;
            
            modal.style.display = 'flex';
        }

        function nextLevel() {
            document.getElementById('resultModal').style.display = 'none';
            
            if (currentLevelIndex < learningData[currentClassLevel].length - 1) {
                currentLevelIndex++;
                loadLevel();
                resetQuestionDisplay();
            } else {
                alert(`üéä Selamat! Kamu telah menyelesaikan semua level untuk Kelas ${currentClassLevel}!\n\nTotal Skor: ${totalScore}\n\nTerus belajar dan tingkatkan kemampuan menyimakmu!`);
                backToHome();
            }
        }

        function retryLevel() {
            document.getElementById('resultModal').style.display = 'none';
            loadLevel();
            resetQuestionDisplay();
        }

        function resetQuestionDisplay() {
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'wrong');
                opt.style.pointerEvents = 'auto';
            });
            document.getElementById('submitButton').style.display = 'block';
            document.getElementById('submitButton').disabled = true;
        }

        function backToHome() {
            // Stop any ongoing speech
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('welcomeScreen').classList.remove('hidden');
            currentLevelIndex = 0;
            totalScore = 0;
            currentAnswers = {};
            isPlaying = false;
            isPaused = false;
            document.getElementById('currentScore').textContent = '0';
            document.getElementById('correctAnswers').textContent = '0/5';
        }

        function updateProgress(percent) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = Math.round(percent) + '%';
        }

        // Load voices when available
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => {
                const voices = speechSynthesis.getVoices();
                console.log('Available voices:', voices.length);
            };
        }

        // Sound effects simulation
        function playSound(type) {
            // Simulasi efek suara (dalam implementasi nyata bisa menggunakan Audio API)
            console.log(`Playing ${type} sound`);
        }
    </script>
</body>
</html>